/************************************************************************
	fft.c

    FFT Audio Analysis
    Copyright (C) 2011 Simon Inns

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see <http://www.gnu.org/licenses/>.

	Email: simon.inns@gmail.com

************************************************************************/

#ifndef FFT_C
#define FFT_C

//#include <htc.h>
#include "fft.h"

// fix_fft.c - Fixed-point in-place Fast Fourier Transform

// All data are fixed-point short integers, in which -32768
// to +32768 represent -1.0 to +1.0 respectively. Integer
// arithmetic is used for speed, instead of the more natural
// floating-point.
//
// For the forward FFT (time -> freq), fixed scaling is
// performed to prevent arithmetic overflow, and to map a 0dB
// sine/cosine wave (i.e. amplitude = 32767) to two -6dB freq
// coefficients.
//
// Written by:  Tom Roberts  11/8/89
// Made portable:  Malcolm Slaney 12/15/94 malcolm@interval.com
// Enhanced:  Dimitrios P. Bouras  14 Jun 2006 dbouras@ieee.org
// Ported to PIC18F:  Simon Inns 20110104

// Since we only use 3/4 of N_WAVE, we define only
// this many samples, in order to conserve data space.
// VERSION 1
// const short Sinewave[N_WAVE-N_WAVE/4] = {
//       0,    201,    402,    603,    804,   1005,   1206,   1406,
//    1607,   1808,   2009,   2209,   2410,   2610,   2811,   3011,
//    3211,   3411,   3611,   3811,   4011,   4210,   4409,   4608,
//    4807,   5006,   5205,   5403,   5601,   5799,   5997,   6195,
//    6392,   6589,   6786,   6982,   7179,   7375,   7571,   7766,
//    7961,   8156,   8351,   8545,   8739,   8932,   9126,   9319,
//    9511,   9703,   9895,  10087,  10278,  10469,  10659,  10849,
//   11038,  11227,  11416,  11604,  11792,  11980,  12166,  12353,
//   12539,  12724,  12909,  13094,  13278,  13462,  13645,  13827,
//   14009,  14191,  14372,  14552,  14732,  14911,  15090,  15268,
//   15446,  15623,  15799,  15975,  16150,  16325,  16499,  16672,
//   16845,  17017,  17189,  17360,  17530,  17699,  17868,  18036,
//   18204,  18371,  18537,  18702,  18867,  19031,  19194,  19357,
//   19519,  19680,  19840,  20000,  20159,  20317,  20474,  20631,
//   20787,  20942,  21096,  21249,  21402,  21554,  21705,  21855,
//   22004,  22153,  22301,  22448,  22594,  22739,  22883,  23027,
//   23169,  23311,  23452,  23592,  23731,  23869,  24006,  24143,
//   24278,  24413,  24546,  24679,  24811,  24942,  25072,  25201,
//   25329,  25456,  25582,  25707,  25831,  25954,  26077,  26198,
//   26318,  26437,  26556,  26673,  26789,  26905,  27019,  27132,
//   27244,  27355,  27466,  27575,  27683,  27790,  27896,  28001,
//   28105,  28208,  28309,  28410,  28510,  28608,  28706,  28802,
//   28897,  28992,  29085,  29177,  29268,  29358,  29446,  29534,
//   29621,  29706,  29790,  29873,  29955,  30036,  30116,  30195,
//   30272,  30349,  30424,  30498,  30571,  30643,  30713,  30783,
//   30851,  30918,  30984,  31049,  31113,  31175,  31236,  31297,
//   31356,  31413,  31470,  31525,  31580,  31633,  31684,  31735,
//   31785,  31833,  31880,  31926,  31970,  32014,  32056,  32097,
//   32137,  32176,  32213,  32249,  32284,  32318,  32350,  32382,
//   32412,  32441,  32468,  32495,  32520,  32544,  32567,  32588,
//   32609,  32628,  32646,  32662,  32678,  32692,  32705,  32717,
//   32727,  32736,  32744,  32751,  32757,  32761,  32764,  32766,
//   32767,  32766,  32764,  32761,  32757,  32751,  32744,  32736,
//   32727,  32717,  32705,  32692,  32678,  32662,  32646,  32628,
//   32609,  32588,  32567,  32544,  32520,  32495,  32468,  32441,
//   32412,  32382,  32350,  32318,  32284,  32249,  32213,  32176,
//   32137,  32097,  32056,  32014,  31970,  31926,  31880,  31833,
//   31785,  31735,  31684,  31633,  31580,  31525,  31470,  31413,
//   31356,  31297,  31236,  31175,  31113,  31049,  30984,  30918,
//   30851,  30783,  30713,  30643,  30571,  30498,  30424,  30349,
//   30272,  30195,  30116,  30036,  29955,  29873,  29790,  29706,
//   29621,  29534,  29446,  29358,  29268,  29177,  29085,  28992,
//   28897,  28802,  28706,  28608,  28510,  28410,  28309,  28208,
//   28105,  28001,  27896,  27790,  27683,  27575,  27466,  27355,
//   27244,  27132,  27019,  26905,  26789,  26673,  26556,  26437,
//   26318,  26198,  26077,  25954,  25831,  25707,  25582,  25456,
//   25329,  25201,  25072,  24942,  24811,  24679,  24546,  24413,
//   24278,  24143,  24006,  23869,  23731,  23592,  23452,  23311,
//   23169,  23027,  22883,  22739,  22594,  22448,  22301,  22153,
//   22004,  21855,  21705,  21554,  21402,  21249,  21096,  20942,
//   20787,  20631,  20474,  20317,  20159,  20000,  19840,  19680,
//   19519,  19357,  19194,  19031,  18867,  18702,  18537,  18371,
//   18204,  18036,  17868,  17699,  17530,  17360,  17189,  17017,
//   16845,  16672,  16499,  16325,  16150,  15975,  15799,  15623,
//   15446,  15268,  15090,  14911,  14732,  14552,  14372,  14191,
//   14009,  13827,  13645,  13462,  13278,  13094,  12909,  12724,
//   12539,  12353,  12166,  11980,  11792,  11604,  11416,  11227,
//   11038,  10849,  10659,  10469,  10278,  10087,   9895,   9703,
//    9511,   9319,   9126,   8932,   8739,   8545,   8351,   8156,
//    7961,   7766,   7571,   7375,   7179,   6982,   6786,   6589,
//    6392,   6195,   5997,   5799,   5601,   5403,   5205,   5006,
//    4807,   4608,   4409,   4210,   4011,   3811,   3611,   3411,
//    3211,   3011,   2811,   2610,   2410,   2209,   2009,   1808,
//    1607,   1406,   1206,   1005,    804,    603,    402,    201,
//       0,   -201,   -402,   -603,   -804,  -1005,  -1206,  -1406,
//   -1607,  -1808,  -2009,  -2209,  -2410,  -2610,  -2811,  -3011,
//   -3211,  -3411,  -3611,  -3811,  -4011,  -4210,  -4409,  -4608,
//   -4807,  -5006,  -5205,  -5403,  -5601,  -5799,  -5997,  -6195,
//   -6392,  -6589,  -6786,  -6982,  -7179,  -7375,  -7571,  -7766,
//   -7961,  -8156,  -8351,  -8545,  -8739,  -8932,  -9126,  -9319,
//   -9511,  -9703,  -9895, -10087, -10278, -10469, -10659, -10849,
//  -11038, -11227, -11416, -11604, -11792, -11980, -12166, -12353,
//  -12539, -12724, -12909, -13094, -13278, -13462, -13645, -13827,
//  -14009, -14191, -14372, -14552, -14732, -14911, -15090, -15268,
//  -15446, -15623, -15799, -15975, -16150, -16325, -16499, -16672,
//  -16845, -17017, -17189, -17360, -17530, -17699, -17868, -18036,
//  -18204, -18371, -18537, -18702, -18867, -19031, -19194, -19357,
//  -19519, -19680, -19840, -20000, -20159, -20317, -20474, -20631,
//  -20787, -20942, -21096, -21249, -21402, -21554, -21705, -21855,
//  -22004, -22153, -22301, -22448, -22594, -22739, -22883, -23027,
//  -23169, -23311, -23452, -23592, -23731, -23869, -24006, -24143,
//  -24278, -24413, -24546, -24679, -24811, -24942, -25072, -25201,
//  -25329, -25456, -25582, -25707, -25831, -25954, -26077, -26198,
//  -26318, -26437, -26556, -26673, -26789, -26905, -27019, -27132,
//  -27244, -27355, -27466, -27575, -27683, -27790, -27896, -28001,
//  -28105, -28208, -28309, -28410, -28510, -28608, -28706, -28802,
//  -28897, -28992, -29085, -29177, -29268, -29358, -29446, -29534,
//  -29621, -29706, -29790, -29873, -29955, -30036, -30116, -30195,
//  -30272, -30349, -30424, -30498, -30571, -30643, -30713, -30783,
//  -30851, -30918, -30984, -31049, -31113, -31175, -31236, -31297,
//  -31356, -31413, -31470, -31525, -31580, -31633, -31684, -31735,
//  -31785, -31833, -31880, -31926, -31970, -32014, -32056, -32097,
//  -32137, -32176, -32213, -32249, -32284, -32318, -32350, -32382,
//  -32412, -32441, -32468, -32495, -32520, -32544, -32567, -32588,
//  -32609, -32628, -32646, -32662, -32678, -32692, -32705, -32717,
//  -32727, -32736, -32744, -32751, -32757, -32761, -32764, -32766,
// };

// VERSION 1
/*
  fix_fft() - perform forward fast Fourier transform.
  fr[n],fi[n] are real and imaginary arrays, both INPUT AND
  RESULT (in-place FFT), with 0 <= n < 2**m
*/
// void fix_fft(short fr[], short fi[], short m)
// {
// 	long int mr = 0, nn, i, j, l, k, istep, n, shift;
// 	short qr, qi, tr, ti, wr, wi;
//
// 	n = 1 << m;
// 	nn = n - 1;
//
// 	/* max FFT size = N_WAVE */
// 	//if (n > N_WAVE) return -1;
//
// 	/* decimation in time - re-order data */
// 	for (m=1; m<=nn; ++m)
// 	{
// 		l = n;
// 		do
// 		{
// 			l >>= 1;
// 		} while (mr+l > nn);
//
// 		mr = (mr & (l-1)) + l;
// 		if (mr <= m) continue;
//
// 		tr = fr[m];
// 		fr[m] = fr[mr];
// 		fr[mr] = tr;
// 		ti = fi[m];
// 		fi[m] = fi[mr];
// 		fi[mr] = ti;
// 	}
//
// 	l = 1;
// 	k = LOG2_N_WAVE-1;
//
// 	while (l < n)
// 	{
// 		/*
// 		  fixed scaling, for proper normalization --
// 		  there will be log2(n) passes, so this results
// 		  in an overall factor of 1/n, distributed to
// 		  maximize arithmetic accuracy.
//
// 		  It may not be obvious, but the shift will be
// 		  performed on each data point exactly once,
// 		  during this pass.
// 		*/
//
// 		// Variables for multiplication code
// 		long int c;
// 		short b;
//
// 		istep = l << 1;
// 		for (m=0; m<l; ++m)
// 		{
// 			j = m << k;
// 			/* 0 <= j < N_WAVE/2 */
// 			wr =  Sinewave[j+N_WAVE/4];
// 			wi = -Sinewave[j];
//
// 			wr >>= 1;
// 			wi >>= 1;
//
// 			for (i=m; i<n; i+=istep)
// 			{
// 				j = i + l;
//
// 				// Here I unrolled the multiplications to prevent overhead
// 				// for procedural calls (we don't need to be clever about
// 				// the actual multiplications since the pic has an onboard
// 				// 8x8 multiplier in the ALU):
//
// 				// tr = FIX_MPY(wr,fr[j]) - FIX_MPY(wi,fi[j]);
// 				c = ((long int)wr * (long int)fr[j]);
// 				c = c >> 14;
// 				b = c & 0x01;
// 				tr = (c >> 1) + b;
//
// 				c = ((long int)wi * (long int)fi[j]);
// 				c = c >> 14;
// 				b = c & 0x01;
// 				tr = tr - ((c >> 1) + b);
//
// 				// ti = FIX_MPY(wr,fi[j]) + FIX_MPY(wi,fr[j]);
// 				c = ((long int)wr * (long int)fi[j]);
// 				c = c >> 14;
// 				b = c & 0x01;
// 				ti = (c >> 1) + b;
//
// 				c = ((long int)wi * (long int)fr[j]);
// 				c = c >> 14;
// 				b = c & 0x01;
// 				ti = ti + ((c >> 1) + b);
//
// 				qr = fr[i];
// 				qi = fi[i];
// 				qr >>= 1;
// 				qi >>= 1;
//
// 				fr[j] = qr - tr;
// 				fi[j] = qi - ti;
// 				fr[i] = qr + tr;
// 				fi[i] = qi + ti;
// 			}
// 		}
//
// 		--k;
// 		l = istep;
// 	}
// }

#define FIX_MPY(DEST,A,B)       DEST = ((long)(A) * (long)(B))>>15

#if N_WAVE != 1024
ERROR:N_WAVE != 1024
#endif
    short gst_spectrum_Sinewave[1024] = {
0, 201, 402, 603, 804, 1005, 1206, 1406,
      1607, 1808, 2009, 2209, 2410, 2610, 2811, 3011,
      3211, 3411, 3611, 3811, 4011, 4210, 4409, 4608,
      4807, 5006, 5205, 5403, 5601, 5799, 5997, 6195,
      6392, 6589, 6786, 6982, 7179, 7375, 7571, 7766,
      7961, 8156, 8351, 8545, 8739, 8932, 9126, 9319,
      9511, 9703, 9895, 10087, 10278, 10469, 10659, 10849,
      11038, 11227, 11416, 11604, 11792, 11980, 12166, 12353,
      12539, 12724, 12909, 13094, 13278, 13462, 13645, 13827,
      14009, 14191, 14372, 14552, 14732, 14911, 15090, 15268,
      15446, 15623, 15799, 15975, 16150, 16325, 16499, 16672,
      16845, 17017, 17189, 17360, 17530, 17699, 17868, 18036,
      18204, 18371, 18537, 18702, 18867, 19031, 19194, 19357,
      19519, 19680, 19840, 20000, 20159, 20317, 20474, 20631,
      20787, 20942, 21096, 21249, 21402, 21554, 21705, 21855,
      22004, 22153, 22301, 22448, 22594, 22739, 22883, 23027,
      23169, 23311, 23452, 23592, 23731, 23869, 24006, 24143,
      24278, 24413, 24546, 24679, 24811, 24942, 25072, 25201,
      25329, 25456, 25582, 25707, 25831, 25954, 26077, 26198,
      26318, 26437, 26556, 26673, 26789, 26905, 27019, 27132,
      27244, 27355, 27466, 27575, 27683, 27790, 27896, 28001,
      28105, 28208, 28309, 28410, 28510, 28608, 28706, 28802,
      28897, 28992, 29085, 29177, 29268, 29358, 29446, 29534,
      29621, 29706, 29790, 29873, 29955, 30036, 30116, 30195,
      30272, 30349, 30424, 30498, 30571, 30643, 30713, 30783,
      30851, 30918, 30984, 31049,
      31113, 31175, 31236, 31297,
      31356, 31413, 31470, 31525, 31580, 31633, 31684, 31735,
      31785, 31833, 31880, 31926, 31970, 32014, 32056, 32097,
      32137, 32176, 32213, 32249, 32284, 32318, 32350, 32382,
      32412, 32441, 32468, 32495, 32520, 32544, 32567, 32588,
      32609, 32628, 32646, 32662, 32678, 32692, 32705, 32717,
      32727, 32736, 32744, 32751, 32757, 32761, 32764, 32766,
      32767, 32766, 32764, 32761, 32757, 32751, 32744, 32736,
      32727, 32717, 32705, 32692, 32678, 32662, 32646, 32628,
      32609, 32588, 32567, 32544, 32520, 32495, 32468, 32441,
      32412, 32382, 32350, 32318, 32284, 32249, 32213, 32176,
      32137, 32097, 32056, 32014, 31970, 31926, 31880, 31833,
      31785, 31735, 31684, 31633, 31580, 31525, 31470, 31413,
      31356, 31297, 31236, 31175, 31113, 31049, 30984, 30918,
      30851, 30783, 30713, 30643, 30571, 30498, 30424, 30349,
      30272, 30195, 30116, 30036, 29955, 29873, 29790, 29706,
      29621, 29534, 29446, 29358, 29268, 29177, 29085, 28992,
      28897, 28802, 28706, 28608, 28510, 28410, 28309, 28208,
      28105, 28001, 27896, 27790, 27683, 27575, 27466, 27355,
      27244, 27132, 27019, 26905, 26789, 26673, 26556, 26437,
      26318, 26198, 26077, 25954, 25831, 25707, 25582, 25456,
      25329, 25201, 25072, 24942, 24811, 24679, 24546, 24413,
      24278, 24143, 24006, 23869, 23731, 23592, 23452, 23311,
      23169, 23027, 22883, 22739, 22594, 22448, 22301, 22153,
      22004, 21855, 21705, 21554, 21402, 21249, 21096, 20942,
      20787, 20631, 20474, 20317, 20159, 20000, 19840, 19680,
      19519, 19357, 19194, 19031, 18867, 18702, 18537, 18371,
      18204, 18036, 17868, 17699, 17530, 17360, 17189, 17017,
      16845, 16672, 16499, 16325, 16150, 15975, 15799, 15623,
      15446, 15268, 15090, 14911, 14732, 14552, 14372, 14191,
      14009, 13827, 13645, 13462, 13278, 13094, 12909, 12724,
      12539, 12353, 12166, 11980, 11792, 11604, 11416, 11227,
      11038, 10849, 10659, 10469, 10278, 10087, 9895, 9703,
      9511, 9319, 9126, 8932, 8739, 8545, 8351, 8156,
      7961, 7766, 7571, 7375, 7179, 6982, 6786, 6589,
      6392, 6195, 5997, 5799, 5601, 5403, 5205, 5006,
      4807, 4608, 4409, 4210, 4011, 3811, 3611, 3411,
      3211, 3011, 2811, 2610, 2410, 2209, 2009, 1808,
      1607, 1406, 1206, 1005, 804, 603, 402, 201,
      0, -201, -402, -603, -804, -1005, -1206, -1406,
      -1607, -1808, -2009, -2209, -2410, -2610, -2811, -3011,
      -3211, -3411, -3611, -3811, -4011, -4210, -4409, -4608,
      -4807, -5006, -5205, -5403, -5601, -5799, -5997, -6195,
      -6392, -6589, -6786, -6982, -7179, -7375, -7571, -7766,
      -7961, -8156, -8351, -8545, -8739, -8932, -9126, -9319,
      -9511, -9703, -9895, -10087, -10278, -10469, -10659, -10849,
      -11038, -11227, -11416, -11604, -11792, -11980, -12166, -12353,
      -12539, -12724, -12909, -13094, -13278, -13462, -13645, -13827,
      -14009, -14191, -14372, -14552, -14732, -14911, -15090, -15268,
      -15446, -15623, -15799, -15975, -16150, -16325, -16499, -16672,
      -16845, -17017, -17189, -17360, -17530, -17699, -17868, -18036,
      -18204, -18371, -18537, -18702, -18867, -19031, -19194, -19357,
      -19519, -19680, -19840, -20000, -20159, -20317, -20474, -20631,
      -20787, -20942, -21096, -21249, -21402, -21554, -21705, -21855,
      -22004, -22153, -22301, -22448, -22594, -22739, -22883, -23027,
      -23169, -23311, -23452, -23592, -23731, -23869, -24006, -24143,
      -24278, -24413, -24546, -24679, -24811, -24942, -25072, -25201,
      -25329, -25456, -25582, -25707, -25831, -25954, -26077, -26198,
      -26318, -26437, -26556, -26673, -26789, -26905, -27019, -27132,
      -27244, -27355, -27466, -27575, -27683, -27790, -27896, -28001,
      -28105, -28208, -28309, -28410, -28510, -28608, -28706, -28802,
      -28897, -28992, -29085, -29177, -29268, -29358, -29446, -29534,
      -29621, -29706, -29790, -29873, -29955, -30036, -30116, -30195,
      -30272, -30349, -30424, -30498, -30571, -30643, -30713, -30783,
      -30851, -30918, -30984, -31049, -31113, -31175, -31236, -31297,
      -31356, -31413, -31470, -31525, -31580, -31633, -31684, -31735,
      -31785, -31833, -31880, -31926, -31970, -32014, -32056, -32097,
      -32137, -32176, -32213, -32249, -32284, -32318, -32350, -32382,
      -32412, -32441, -32468, -32495, -32520, -32544, -32567, -32588,
      -32609, -32628, -32646, -32662, -32678, -32692, -32705, -32717,
      -32727, -32736, -32744, -32751, -32757, -32761, -32764, -32766,
      -32767, -32766, -32764, -32761, -32757, -32751, -32744, -32736,
      -32727, -32717, -32705, -32692, -32678, -32662, -32646, -32628,
      -32609, -32588, -32567, -32544, -32520, -32495, -32468, -32441,
      -32412, -32382, -32350, -32318, -32284, -32249, -32213, -32176,
      -32137, -32097, -32056, -32014, -31970, -31926, -31880, -31833,
      -31785, -31735, -31684, -31633, -31580, -31525, -31470, -31413,
      -31356, -31297, -31236, -31175, -31113, -31049, -30984, -30918,
      -30851, -30783, -30713, -30643, -30571, -30498, -30424, -30349,
      -30272, -30195, -30116, -30036, -29955, -29873, -29790, -29706,
      -29621, -29534, -29446, -29358, -29268, -29177, -29085, -28992,
      -28897, -28802, -28706, -28608, -28510, -28410, -28309, -28208,
      -28105, -28001, -27896, -27790, -27683, -27575, -27466, -27355,
      -27244, -27132, -27019, -26905, -26789, -26673, -26556, -26437,
      -26318, -26198, -26077, -25954, -25831, -25707, -25582, -25456,
      -25329, -25201, -25072, -24942, -24811, -24679, -24546, -24413,
      -24278, -24143, -24006, -23869, -23731, -23592, -23452, -23311,
      -23169, -23027, -22883, -22739, -22594, -22448, -22301, -22153,
      -22004, -21855, -21705, -21554, -21402, -21249, -21096, -20942,
      -20787, -20631, -20474, -20317, -20159, -20000, -19840, -19680,
      -19519, -19357, -19194, -19031, -18867, -18702, -18537, -18371,
      -18204, -18036, -17868, -17699, -17530, -17360, -17189, -17017,
      -16845, -16672, -16499, -16325, -16150, -15975, -15799, -15623,
      -15446, -15268, -15090, -14911, -14732, -14552, -14372, -14191,
      -14009, -13827, -13645, -13462, -13278, -13094, -12909, -12724,
      -12539, -12353, -12166, -11980, -11792, -11604, -11416, -11227,
      -11038, -10849, -10659, -10469, -10278, -10087, -9895, -9703,
      -9511, -9319, -9126, -8932, -8739, -8545, -8351, -8156,
      -7961, -7766, -7571, -7375, -7179, -6982, -6786, -6589,
      -6392, -6195, -5997, -5799, -5601, -5403, -5205, -5006,
      -4807, -4608, -4409, -4210, -4011, -3811, -3611, -3411,
      -3211, -3011, -2811, -2610, -2410, -2209, -2009, -1808,
      -1607, -1406, -1206, -1005, -804, -603, -402, -201,};

// short gst_spectrum_Sinewave[2048] = {0, 100, 201, 301, 402, 502, 603, 703, 804, 904, 1005, 1105, 1206, 1306, 1407, 1507, 1607, 1708, 1808, 1909, 2009, 2109, 2210, 2310, 2410, 2510, 2611, 2711, 2811, 2911, 3011, 3111, 3211, 3311, 3411, 3511, 3611, 3711, 3811, 3911, 4011, 4110, 4210, 4310, 4409, 4509, 4609, 4708, 4808, 4907, 5006, 5106, 5205, 5304, 5403, 5503, 5602, 5701, 5800, 5898, 5997, 6096, 6195, 6294, 6392, 6491, 6589, 6688, 6786, 6884, 6983, 7081, 7179, 7277, 7375, 7473, 7571, 7669, 7766, 7864, 7961, 8059, 8156, 8254, 8351, 8448, 8545, 8642, 8739, 8836, 8933, 9029, 9126, 9223, 9319, 9415, 9512, 9608, 9704, 9800, 9896, 9991, 10087, 10183, 10278, 10374, 10469, 10564, 10659, 10754, 10849, 10944, 11039, 11133, 11228, 11322, 11416, 11511, 11605, 11699, 11793, 11886, 11980, 12073, 12167, 12260, 12353, 12446, 12539, 12632, 12725, 12817, 12910, 13002, 13094, 13186, 13278, 13370, 13462, 13554, 13645, 13736, 13828, 13919, 14010, 14100, 14191, 14282, 14372, 14462, 14552, 14642, 14732, 14822, 14912, 15001, 15090, 15180, 15269, 15357, 15446, 15535, 15623, 15712, 15800, 15888, 15976, 16063, 16151, 16238, 16325, 16413, 16499, 16586, 16673, 16759, 16846, 16932, 17018, 17104, 17189, 17275, 17360, 17445, 17530, 17615, 17700, 17784, 17869, 17953, 18037, 18121, 18204, 18288, 18371, 18454, 18537, 18620, 18703, 18785, 18868, 18950, 19032, 19113, 19195, 19276, 19358, 19439, 19519, 19600, 19681, 19761, 19841, 19921, 20001, 20080, 20159, 20239, 20318, 20396, 20475, 20553, 20631, 20709, 20787, 20865, 20942, 21020, 21097, 21173, 21250, 21326, 21403, 21479, 21555, 21630, 21706, 21781, 21856, 21931, 22005, 22080, 22154, 22228, 22301, 22375, 22448, 22521, 22594, 22667, 22740, 22812, 22884, 22956, 23027, 23099, 23170, 23241, 23312, 23382, 23453, 23523, 23593, 23662, 23732, 23801, 23870, 23939, 24007, 24075, 24144, 24211, 24279, 24346, 24414, 24480, 24547, 24614, 24680, 24746, 24812, 24877, 24943, 25008, 25073, 25137, 25201, 25266, 25330, 25393, 25457, 25520, 25583, 25645, 25708, 25770, 25832, 25894, 25955, 26016, 26077, 26138, 26199, 26259, 26319, 26379, 26438, 26498, 26557, 26615, 26674, 26732, 26790, 26848, 26905, 26963, 27020, 27076, 27133, 27189, 27245, 27301, 27356, 27411, 27466, 27521, 27576, 27630, 27684, 27737, 27791, 27844, 27897, 27949, 28002, 28054, 28106, 28157, 28208, 28259, 28310, 28361, 28411, 28461, 28511, 28560, 28609, 28658, 28707, 28755, 28803, 28851, 28898, 28946, 28993, 29039, 29086, 29132, 29178, 29223, 29269, 29314, 29359, 29403, 29447, 29491, 29535, 29578, 29621, 29664, 29707, 29749, 29791, 29833, 29874, 29915, 29956, 29997, 30037, 30077, 30117, 30156, 30196, 30235, 30273, 30312, 30350, 30387, 30425, 30462, 30499, 30535, 30572, 30608, 30644, 30679, 30714, 30749, 30784, 30818, 30852, 30886, 30919, 30952, 30985, 31018, 31050, 31082, 31114, 31145, 31176, 31207, 31237, 31268, 31298, 31327, 31357, 31386, 31414, 31443, 31471, 31499, 31526, 31554, 31581, 31607, 31634, 31660, 31685, 31711, 31736, 31761, 31785, 31810, 31834, 31857, 31881, 31904, 31927, 31949, 31971, 31993, 32015, 32036, 32057, 32078, 32098, 32118, 32138, 32157, 32176, 32195, 32214, 32232, 32250, 32268, 32285, 32302, 32319, 32335, 32351, 32367, 32383, 32398, 32413, 32427, 32442, 32456, 32469, 32483, 32496, 32509, 32521, 32533, 32545, 32557, 32568, 32579, 32589, 32600, 32610, 32619, 32629, 32638, 32647, 32655, 32663, 32671, 32679, 32686, 32693, 32700, 32706, 32712, 32718, 32723, 32728, 32733, 32737, 32741, 32745, 32749, 32752, 32755, 32758, 32760, 32762, 32764, 32765, 32766, 32767, 32767, 32768, 32767, 32767, 32766, 32765, 32764, 32762, 32760, 32758, 32755, 32752, 32749, 32745, 32741, 32737, 32733, 32728, 32723, 32718, 32712, 32706, 32700, 32693, 32686, 32679, 32671, 32663, 32655, 32647, 32638, 32629, 32619, 32610, 32600, 32589, 32579, 32568, 32557, 32545, 32533, 32521, 32509, 32496, 32483, 32469, 32456, 32442, 32427, 32413, 32398, 32383, 32367, 32351, 32335, 32319, 32302, 32285, 32268, 32250, 32232, 32214, 32195, 32176, 32157, 32138, 32118, 32098, 32078, 32057, 32036, 32015, 31993, 31971, 31949, 31927, 31904, 31881, 31857, 31834, 31810, 31785, 31761, 31736, 31711, 31685, 31660, 31634, 31607, 31581, 31554, 31526, 31499, 31471, 31443, 31414, 31386, 31357, 31327, 31298, 31268, 31237, 31207, 31176, 31145, 31114, 31082, 31050, 31018, 30985, 30952, 30919, 30886, 30852, 30818, 30784, 30749, 30714, 30679, 30644, 30608, 30572, 30535, 30499, 30462, 30425, 30387, 30350, 30312, 30273, 30235, 30196, 30156, 30117, 30077, 30037, 29997, 29956, 29915, 29874, 29833, 29791, 29749, 29707, 29664, 29621, 29578, 29535, 29491, 29447, 29403, 29359, 29314, 29269, 29223, 29178, 29132, 29086, 29039, 28993, 28946, 28898, 28851, 28803, 28755, 28707, 28658, 28609, 28560, 28511, 28461, 28411, 28361, 28310, 28259, 28208, 28157, 28106, 28054, 28002, 27949, 27897, 27844, 27791, 27737, 27684, 27630, 27576, 27521, 27466, 27411, 27356, 27301, 27245, 27189, 27133, 27076, 27020, 26963, 26905, 26848, 26790, 26732, 26674, 26615, 26557, 26498, 26438, 26379, 26319, 26259, 26199, 26138, 26077, 26016, 25955, 25894, 25832, 25770, 25708, 25645, 25583, 25520, 25457, 25393, 25330, 25266, 25201, 25137, 25073, 25008, 24943, 24877, 24812, 24746, 24680, 24614, 24547, 24480, 24414, 24346, 24279, 24211, 24144, 24075, 24007, 23939, 23870, 23801, 23732, 23662, 23593, 23523, 23453, 23382, 23312, 23241, 23170, 23099, 23027, 22956, 22884, 22812, 22740, 22667, 22594, 22521, 22448, 22375, 22301, 22228, 22154, 22080, 22005, 21931, 21856, 21781, 21706, 21630, 21555, 21479, 21403, 21326, 21250, 21173, 21097, 21020, 20942, 20865, 20787, 20709, 20631, 20553, 20475, 20396, 20318, 20239, 20159, 20080, 20001, 19921, 19841, 19761, 19681, 19600, 19519, 19439, 19358, 19276, 19195, 19113, 19032, 18950, 18868, 18785, 18703, 18620, 18537, 18454, 18371, 18288, 18204, 18121, 18037, 17953, 17869, 17784, 17700, 17615, 17530, 17445, 17360, 17275, 17189, 17104, 17018, 16932, 16846, 16759, 16673, 16586, 16499, 16413, 16325, 16238, 16151, 16063, 15976, 15888, 15800, 15712, 15623, 15535, 15446, 15357, 15269, 15180, 15090, 15001, 14912, 14822, 14732, 14642, 14552, 14462, 14372, 14282, 14191, 14100, 14010, 13919, 13828, 13736, 13645, 13554, 13462, 13370, 13278, 13186, 13094, 13002, 12910, 12817, 12725, 12632, 12539, 12446, 12353, 12260, 12167, 12073, 11980, 11886, 11793, 11699, 11605, 11511, 11416, 11322, 11228, 11133, 11039, 10944, 10849, 10754, 10659, 10564, 10469, 10374, 10278, 10183, 10087, 9991, 9896, 9800, 9704, 9608, 9512, 9415, 9319, 9223, 9126, 9029, 8933, 8836, 8739, 8642, 8545, 8448, 8351, 8254, 8156, 8059, 7961, 7864, 7766, 7669, 7571, 7473, 7375, 7277, 7179, 7081, 6983, 6884, 6786, 6688, 6589, 6491, 6392, 6294, 6195, 6096, 5997, 5898, 5800, 5701, 5602, 5503, 5403, 5304, 5205, 5106, 5006, 4907, 4808, 4708, 4609, 4509, 4409, 4310, 4210, 4110, 4011, 3911, 3811, 3711, 3611, 3511, 3411, 3311, 3211, 3111, 3011, 2911, 2811, 2711, 2611, 2510, 2410, 2310, 2210, 2109, 2009, 1909, 1808, 1708, 1607, 1507, 1407, 1306, 1206, 1105, 1005, 904, 804, 703, 603, 502, 402, 301, 201, 100, 0, -100, -201, -301, -402, -502, -603, -703, -804, -904, -1005, -1105, -1206, -1306, -1407, -1507, -1607, -1708, -1808, -1909, -2009, -2109, -2210, -2310, -2410, -2510, -2611, -2711, -2811, -2911, -3011, -3111, -3211, -3311, -3411, -3511, -3611, -3711, -3811, -3911, -4011, -4110, -4210, -4310, -4409, -4509, -4609, -4708, -4808, -4907, -5006, -5106, -5205, -5304, -5403, -5503, -5602, -5701, -5800, -5898, -5997, -6096, -6195, -6294, -6392, -6491, -6589, -6688, -6786, -6884, -6983, -7081, -7179, -7277, -7375, -7473, -7571, -7669, -7766, -7864, -7961, -8059, -8156, -8254, -8351, -8448, -8545, -8642, -8739, -8836, -8933, -9029, -9126, -9223, -9319, -9415, -9512, -9608, -9704, -9800, -9896, -9991, -10087, -10183, -10278, -10374, -10469, -10564, -10659, -10754, -10849, -10944, -11039, -11133, -11228, -11322, -11416, -11511, -11605, -11699, -11793, -11886, -11980, -12073, -12167, -12260, -12353, -12446, -12539, -12632, -12725, -12817, -12910, -13002, -13094, -13186, -13278, -13370, -13462, -13554, -13645, -13736, -13828, -13919, -14010, -14100, -14191, -14282, -14372, -14462, -14552, -14642, -14732, -14822, -14912, -15001, -15090, -15180, -15269, -15357, -15446, -15535, -15623, -15712, -15800, -15888, -15976, -16063, -16151, -16238, -16325, -16413, -16499, -16586, -16673, -16759, -16846, -16932, -17018, -17104, -17189, -17275, -17360, -17445, -17530, -17615, -17700, -17784, -17869, -17953, -18037, -18121, -18204, -18288, -18371, -18454, -18537, -18620, -18703, -18785, -18868, -18950, -19032, -19113, -19195, -19276, -19358, -19439, -19519, -19600, -19681, -19761, -19841, -19921, -20001, -20080, -20159, -20239, -20318, -20396, -20475, -20553, -20631, -20709, -20787, -20865, -20942, -21020, -21097, -21173, -21250, -21326, -21403, -21479, -21555, -21630, -21706, -21781, -21856, -21931, -22005, -22080, -22154, -22228, -22301, -22375, -22448, -22521, -22594, -22667, -22740, -22812, -22884, -22956, -23027, -23099, -23170, -23241, -23312, -23382, -23453, -23523, -23593, -23662, -23732, -23801, -23870, -23939, -24007, -24075, -24144, -24211, -24279, -24346, -24414, -24480, -24547, -24614, -24680, -24746, -24812, -24877, -24943, -25008, -25073, -25137, -25201, -25266, -25330, -25393, -25457, -25520, -25583, -25645, -25708, -25770, -25832, -25894, -25955, -26016, -26077, -26138, -26199, -26259, -26319, -26379, -26438, -26498, -26557, -26615, -26674, -26732, -26790, -26848, -26905, -26963, -27020, -27076, -27133, -27189, -27245, -27301, -27356, -27411, -27466, -27521, -27576, -27630, -27684, -27737, -27791, -27844, -27897, -27949, -28002, -28054, -28106, -28157, -28208, -28259, -28310, -28361, -28411, -28461, -28511, -28560, -28609, -28658, -28707, -28755, -28803, -28851, -28898, -28946, -28993, -29039, -29086, -29132, -29178, -29223, -29269, -29314, -29359, -29403, -29447, -29491, -29535, -29578, -29621, -29664, -29707, -29749, -29791, -29833, -29874, -29915, -29956, -29997, -30037, -30077, -30117, -30156, -30196, -30235, -30273, -30312, -30350, -30387, -30425, -30462, -30499, -30535, -30572, -30608, -30644, -30679, -30714, -30749, -30784, -30818, -30852, -30886, -30919, -30952, -30985, -31018, -31050, -31082, -31114, -31145, -31176, -31207, -31237, -31268, -31298, -31327, -31357, -31386, -31414, -31443, -31471, -31499, -31526, -31554, -31581, -31607, -31634, -31660, -31685, -31711, -31736, -31761, -31785, -31810, -31834, -31857, -31881, -31904, -31927, -31949, -31971, -31993, -32015, -32036, -32057, -32078, -32098, -32118, -32138, -32157, -32176, -32195, -32214, -32232, -32250, -32268, -32285, -32302, -32319, -32335, -32351, -32367, -32383, -32398, -32413, -32427, -32442, -32456, -32469, -32483, -32496, -32509, -32521, -32533, -32545, -32557, -32568, -32579, -32589, -32600, -32610, -32619, -32629, -32638, -32647, -32655, -32663, -32671, -32679, -32686, -32693, -32700, -32706, -32712, -32718, -32723, -32728, -32733, -32737, -32741, -32745, -32749, -32752, -32755, -32758, -32760, -32762, -32764, -32765, -32766, -32767, -32767, -32768, -32767, -32767, -32766, -32765, -32764, -32762, -32760, -32758, -32755, -32752, -32749, -32745, -32741, -32737, -32733, -32728, -32723, -32718, -32712, -32706, -32700, -32693, -32686, -32679, -32671, -32663, -32655, -32647, -32638, -32629, -32619, -32610, -32600, -32589, -32579, -32568, -32557, -32545, -32533, -32521, -32509, -32496, -32483, -32469, -32456, -32442, -32427, -32413, -32398, -32383, -32367, -32351, -32335, -32319, -32302, -32285, -32268, -32250, -32232, -32214, -32195, -32176, -32157, -32138, -32118, -32098, -32078, -32057, -32036, -32015, -31993, -31971, -31949, -31927, -31904, -31881, -31857, -31834, -31810, -31785, -31761, -31736, -31711, -31685, -31660, -31634, -31607, -31581, -31554, -31526, -31499, -31471, -31443, -31414, -31386, -31357, -31327, -31298, -31268, -31237, -31207, -31176, -31145, -31114, -31082, -31050, -31018, -30985, -30952, -30919, -30886, -30852, -30818, -30784, -30749, -30714, -30679, -30644, -30608, -30572, -30535, -30499, -30462, -30425, -30387, -30350, -30312, -30273, -30235, -30196, -30156, -30117, -30077, -30037, -29997, -29956, -29915, -29874, -29833, -29791, -29749, -29707, -29664, -29621, -29578, -29535, -29491, -29447, -29403, -29359, -29314, -29269, -29223, -29178, -29132, -29086, -29039, -28993, -28946, -28898, -28851, -28803, -28755, -28707, -28658, -28609, -28560, -28511, -28461, -28411, -28361, -28310, -28259, -28208, -28157, -28106, -28054, -28002, -27949, -27897, -27844, -27791, -27737, -27684, -27630, -27576, -27521, -27466, -27411, -27356, -27301, -27245, -27189, -27133, -27076, -27020, -26963, -26905, -26848, -26790, -26732, -26674, -26615, -26557, -26498, -26438, -26379, -26319, -26259, -26199, -26138, -26077, -26016, -25955, -25894, -25832, -25770, -25708, -25645, -25583, -25520, -25457, -25393, -25330, -25266, -25201, -25137, -25073, -25008, -24943, -24877, -24812, -24746, -24680, -24614, -24547, -24480, -24414, -24346, -24279, -24211, -24144, -24075, -24007, -23939, -23870, -23801, -23732, -23662, -23593, -23523, -23453, -23382, -23312, -23241, -23170, -23099, -23027, -22956, -22884, -22812, -22740, -22667, -22594, -22521, -22448, -22375, -22301, -22228, -22154, -22080, -22005, -21931, -21856, -21781, -21706, -21630, -21555, -21479, -21403, -21326, -21250, -21173, -21097, -21020, -20942, -20865, -20787, -20709, -20631, -20553, -20475, -20396, -20318, -20239, -20159, -20080, -20001, -19921, -19841, -19761, -19681, -19600, -19519, -19439, -19358, -19276, -19195, -19113, -19032, -18950, -18868, -18785, -18703, -18620, -18537, -18454, -18371, -18288, -18204, -18121, -18037, -17953, -17869, -17784, -17700, -17615, -17530, -17445, -17360, -17275, -17189, -17104, -17018, -16932, -16846, -16759, -16673, -16586, -16499, -16413, -16325, -16238, -16151, -16063, -15976, -15888, -15800, -15712, -15623, -15535, -15446, -15357, -15269, -15180, -15090, -15001, -14912, -14822, -14732, -14642, -14552, -14462, -14372, -14282, -14191, -14100, -14010, -13919, -13828, -13736, -13645, -13554, -13462, -13370, -13278, -13186, -13094, -13002, -12910, -12817, -12725, -12632, -12539, -12446, -12353, -12260, -12167, -12073, -11980, -11886, -11793, -11699, -11605, -11511, -11416, -11322, -11228, -11133, -11039, -10944, -10849, -10754, -10659, -10564, -10469, -10374, -10278, -10183, -10087, -9991, -9896, -9800, -9704, -9608, -9512, -9415, -9319, -9223, -9126, -9029, -8933, -8836, -8739, -8642, -8545, -8448, -8351, -8254, -8156, -8059, -7961, -7864, -7766, -7669, -7571, -7473, -7375, -7277, -7179, -7081, -6983, -6884, -6786, -6688, -6589, -6491, -6392, -6294, -6195, -6096, -5997, -5898, -5800, -5701, -5602, -5503, -5403, -5304, -5205, -5106, -5006, -4907, -4808, -4708, -4609, -4509, -4409, -4310, -4210, -4110, -4011, -3911, -3811, -3711, -3611, -3511, -3411, -3311, -3211, -3111, -3011, -2911, -2811, -2711, -2611, -2510, -2410, -2310, -2210, -2109, -2009, -1909, -1808, -1708, -1607, -1507, -1407, -1306, -1206, -1105, -1005, -904, -804, -703, -603, -502, -402, -301, -201, -100,};

// short hanning[2048] = {0, 0, 0, 0, 1, 1, 2, 3, 4, 6, 7, 9, 11, 13, 15, 17, 19, 22, 25, 27, 30, 34, 37, 40, 44, 48, 52, 56, 60, 64, 69, 74, 78, 83, 89, 94, 99, 105, 111, 117, 123, 129, 135, 142, 149, 156, 163, 170, 177, 184, 192, 200, 208, 216, 224, 232, 241, 250, 258, 267, 277, 286, 295, 305, 315, 325, 335, 345, 355, 366, 376, 387, 398, 409, 420, 432, 443, 455, 467, 479, 491, 503, 516, 528, 541, 554, 567, 580, 594, 607, 621, 634, 648, 663, 677, 691, 706, 720, 735, 750, 765, 781, 796, 812, 827, 843, 859, 875, 892, 908, 925, 941, 958, 975, 992, 1010, 1027, 1045, 1062, 1080, 1098, 1117, 1135, 1153, 1172, 1191, 1210, 1229, 1248, 1267, 1287, 1306, 1326, 1346, 1366, 1386, 1406, 1427, 1448, 1468, 1489, 1510, 1531, 1553, 1574, 1596, 1617, 1639, 1661, 1683, 1706, 1728, 1751, 1773, 1796, 1819, 1842, 1865, 1889, 1912, 1936, 1960, 1984, 2008, 2032, 2056, 2081, 2105, 2130, 2155, 2180, 2205, 2230, 2256, 2281, 2307, 2333, 2359, 2385, 2411, 2437, 2464, 2490, 2517, 2544, 2571, 2598, 2625, 2653, 2680, 2708, 2735, 2763, 2791, 2819, 2848, 2876, 2905, 2933, 2962, 2991, 3020, 3049, 3078, 3108, 3137, 3167, 3197, 3227, 3257, 3287, 3317, 3348, 3378, 3409, 3440, 3470, 3502, 3533, 3564, 3595, 3627, 3658, 3690, 3722, 3754, 3786, 3818, 3851, 3883, 3916, 3948, 3981, 4014, 4047, 4080, 4113, 4147, 4180, 4214, 4248, 4282, 4316, 4350, 4384, 4418, 4452, 4487, 4522, 4556, 4591, 4626, 4661, 4696, 4732, 4767, 4803, 4838, 4874, 4910, 4946, 4982, 5018, 5054, 5091, 5127, 5164, 5201, 5237, 5274, 5311, 5348, 5386, 5423, 5460, 5498, 5536, 5573, 5611, 5649, 5687, 5725, 5764, 5802, 5840, 5879, 5917, 5956, 5995, 6034, 6073, 6112, 6151, 6191, 6230, 6270, 6309, 6349, 6389, 6429, 6469, 6509, 6549, 6589, 6630, 6670, 6711, 6751, 6792, 6833, 6874, 6915, 6956, 6997, 7038, 7080, 7121, 7162, 7204, 7246, 7288, 7329, 7371, 7413, 7456, 7498, 7540, 7582, 7625, 7667, 7710, 7753, 7796, 7838, 7881, 7924, 7968, 8011, 8054, 8097, 8141, 8184, 8228, 8271, 8315, 8359, 8403, 8447, 8491, 8535, 8579, 8623, 8668, 8712, 8757, 8801, 8846, 8890, 8935, 8980, 9025, 9070, 9115, 9160, 9205, 9250, 9296, 9341, 9387, 9432, 9478, 9523, 9569, 9615, 9661, 9707, 9752, 9798, 9845, 9891, 9937, 9983, 10029, 10076, 10122, 10169, 10215, 10262, 10309, 10355, 10402, 10449, 10496, 10543, 10590, 10637, 10684, 10731, 10779, 10826, 10873, 10921, 10968, 11015, 11063, 11111, 11158, 11206, 11254, 11301, 11349, 11397, 11445, 11493, 11541, 11589, 11637, 11685, 11734, 11782, 11830, 11878, 11927, 11975, 12024, 12072, 12121, 12169, 12218, 12267, 12315, 12364, 12413, 12462, 12510, 12559, 12608, 12657, 12706, 12755, 12804, 12853, 12903, 12952, 13001, 13050, 13099, 13149, 13198, 13247, 13297, 13346, 13395, 13445, 13494, 13544, 13593, 13643, 13693, 13742, 13792, 13842, 13891, 13941, 13991, 14041, 14090, 14140, 14190, 14240, 14290, 14340, 14389, 14439, 14489, 14539, 14589, 14639, 14689, 14739, 14789, 14839, 14889, 14940, 14990, 15040, 15090, 15140, 15190, 15240, 15291, 15341, 15391, 15441, 15491, 15542, 15592, 15642, 15692, 15742, 15793, 15843, 15893, 15944, 15994, 16044, 16094, 16145, 16195, 16245, 16295, 16346, 16396, 16446, 16497, 16547, 16597, 16648, 16698, 16748, 16798, 16849, 16899, 16949, 16999, 17050, 17100, 17150, 17200, 17251, 17301, 17351, 17401, 17451, 17502, 17552, 17602, 17652, 17702, 17752, 17802, 17853, 17903, 17953, 18003, 18053, 18103, 18153, 18203, 18253, 18303, 18353, 18403, 18452, 18502, 18552, 18602, 18652, 18702, 18751, 18801, 18851, 18901, 18950, 19000, 19050, 19099, 19149, 19198, 19248, 19297, 19347, 19396, 19446, 19495, 19544, 19594, 19643, 19692, 19742, 19791, 19840, 19889, 19938, 19987, 20036, 20085, 20134, 20183, 20232, 20281, 20330, 20379, 20427, 20476, 20525, 20573, 20622, 20671, 20719, 20768, 20816, 20864, 20913, 20961, 21009, 21057, 21106, 21154, 21202, 21250, 21298, 21346, 21394, 21442, 21489, 21537, 21585, 21633, 21680, 21728, 21775, 21823, 21870, 21918, 21965, 22012, 22059, 22106, 22154, 22201, 22248, 22294, 22341, 22388, 22435, 22482, 22528, 22575, 22621, 22668, 22714, 22761, 22807, 22853, 22899, 22945, 22992, 23038, 23083, 23129, 23175, 23221, 23267, 23312, 23358, 23403, 23449, 23494, 23539, 23584, 23629, 23675, 23720, 23764, 23809, 23854, 23899, 23944, 23988, 24033, 24077, 24121, 24166, 24210, 24254, 24298, 24342, 24386, 24430, 24474, 24517, 24561, 24605, 24648, 24691, 24735, 24778, 24821, 24864, 24907, 24950, 24993, 25036, 25078, 25121, 25163, 25206, 25248, 25290, 25333, 25375, 25417, 25459, 25500, 25542, 25584, 25625, 25667, 25708, 25749, 25791, 25832, 25873, 25914, 25955, 25995, 26036, 26077, 26117, 26158, 26198, 26238, 26278, 26318, 26358, 26398, 26438, 26478, 26517, 26557, 26596, 26635, 26674, 26713, 26752, 26791, 26830, 26869, 26907, 26946, 26984, 27023, 27061, 27099, 27137, 27175, 27213, 27250, 27288, 27325, 27363, 27400, 27437, 27474, 27511, 27548, 27585, 27621, 27658, 27694, 27731, 27767, 27803, 27839, 27875, 27911, 27946, 27982, 28018, 28053, 28088, 28123, 28158, 28193, 28228, 28263, 28297, 28332, 28366, 28400, 28434, 28468, 28502, 28536, 28570, 28603, 28637, 28670, 28703, 28736, 28769, 28802, 28835, 28868, 28900, 28933, 28965, 28997, 29029, 29061, 29093, 29124, 29156, 29187, 29219, 29250, 29281, 29312, 29343, 29374, 29404, 29435, 29465, 29495, 29525, 29555, 29585, 29615, 29644, 29674, 29703, 29732, 29761, 29790, 29819, 29848, 29877, 29905, 29933, 29962, 29990, 30018, 30045, 30073, 30101, 30128, 30155, 30183, 30210, 30237, 30263, 30290, 30317, 30343, 30369, 30395, 30421, 30447, 30473, 30499, 30524, 30549, 30575, 30600, 30625, 30649, 30674, 30699, 30723, 30747, 30771, 30795, 30819, 30843, 30866, 30890, 30913, 30936, 30959, 30982, 31005, 31028, 31050, 31073, 31095, 31117, 31139, 31161, 31182, 31204, 31225, 31246, 31267, 31288, 31309, 31330, 31350, 31371, 31391, 31411, 31431, 31451, 31471, 31490, 31509, 31529, 31548, 31567, 31586, 31604, 31623, 31641, 31660, 31678, 31696, 31713, 31731, 31749, 31766, 31783, 31800, 31817, 31834, 31851, 31867, 31884, 31900, 31916, 31932, 31948, 31963, 31979, 31994, 32009, 32024, 32039, 32054, 32069, 32083, 32097, 32112, 32126, 32139, 32153, 32167, 32180, 32193, 32207, 32219, 32232, 32245, 32258, 32270, 32282, 32294, 32306, 32318, 32330, 32341, 32352, 32363, 32375, 32385, 32396, 32407, 32417, 32427, 32437, 32447, 32457, 32467, 32476, 32486, 32495, 32504, 32513, 32522, 32530, 32539, 32547, 32555, 32563, 32571, 32579, 32586, 32594, 32601, 32608, 32615, 32622, 32628, 32635, 32641, 32647, 32653, 32659, 32665, 32670, 32676, 32681, 32686, 32691, 32696, 32700, 32705, 32709, 32713, 32717, 32721, 32725, 32728, 32732, 32735, 32738, 32741, 32744, 32746, 32749, 32751, 32753, 32755, 32757, 32759, 32761, 32762, 32763, 32764, 32765, 32766, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32766, 32765, 32764, 32763, 32762, 32761, 32759, 32757, 32755, 32753, 32751, 32749, 32746, 32744, 32741, 32738, 32735, 32732, 32728, 32725, 32721, 32717, 32713, 32709, 32705, 32700, 32696, 32691, 32686, 32681, 32676, 32670, 32665, 32659, 32653, 32647, 32641, 32635, 32628, 32622, 32615, 32608, 32601, 32594, 32586, 32579, 32571, 32563, 32555, 32547, 32539, 32530, 32522, 32513, 32504, 32495, 32486, 32476, 32467, 32457, 32447, 32437, 32427, 32417, 32407, 32396, 32385, 32375, 32363, 32352, 32341, 32330, 32318, 32306, 32294, 32282, 32270, 32258, 32245, 32232, 32219, 32207, 32193, 32180, 32167, 32153, 32139, 32126, 32112, 32097, 32083, 32069, 32054, 32039, 32024, 32009, 31994, 31979, 31963, 31948, 31932, 31916, 31900, 31884, 31867, 31851, 31834, 31817, 31800, 31783, 31766, 31749, 31731, 31713, 31696, 31678, 31660, 31641, 31623, 31604, 31586, 31567, 31548, 31529, 31509, 31490, 31471, 31451, 31431, 31411, 31391, 31371, 31350, 31330, 31309, 31288, 31267, 31246, 31225, 31204, 31182, 31161, 31139, 31117, 31095, 31073, 31050, 31028, 31005, 30982, 30959, 30936, 30913, 30890, 30866, 30843, 30819, 30795, 30771, 30747, 30723, 30699, 30674, 30649, 30625, 30600, 30575, 30549, 30524, 30499, 30473, 30447, 30421, 30395, 30369, 30343, 30317, 30290, 30263, 30237, 30210, 30183, 30155, 30128, 30101, 30073, 30045, 30018, 29990, 29962, 29933, 29905, 29877, 29848, 29819, 29790, 29761, 29732, 29703, 29674, 29644, 29615, 29585, 29555, 29525, 29495, 29465, 29435, 29404, 29374, 29343, 29312, 29281, 29250, 29219, 29187, 29156, 29124, 29093, 29061, 29029, 28997, 28965, 28933, 28900, 28868, 28835, 28802, 28769, 28736, 28703, 28670, 28637, 28603, 28570, 28536, 28502, 28468, 28434, 28400, 28366, 28332, 28297, 28263, 28228, 28193, 28158, 28123, 28088, 28053, 28018, 27982, 27946, 27911, 27875, 27839, 27803, 27767, 27731, 27694, 27658, 27621, 27585, 27548, 27511, 27474, 27437, 27400, 27363, 27325, 27288, 27250, 27213, 27175, 27137, 27099, 27061, 27023, 26984, 26946, 26907, 26869, 26830, 26791, 26752, 26713, 26674, 26635, 26596, 26557, 26517, 26478, 26438, 26398, 26358, 26318, 26278, 26238, 26198, 26158, 26117, 26077, 26036, 25995, 25955, 25914, 25873, 25832, 25791, 25749, 25708, 25667, 25625, 25584, 25542, 25500, 25459, 25417, 25375, 25333, 25290, 25248, 25206, 25163, 25121, 25078, 25036, 24993, 24950, 24907, 24864, 24821, 24778, 24735, 24691, 24648, 24605, 24561, 24517, 24474, 24430, 24386, 24342, 24298, 24254, 24210, 24166, 24121, 24077, 24033, 23988, 23944, 23899, 23854, 23809, 23764, 23720, 23675, 23629, 23584, 23539, 23494, 23449, 23403, 23358, 23312, 23267, 23221, 23175, 23129, 23083, 23038, 22992, 22945, 22899, 22853, 22807, 22761, 22714, 22668, 22621, 22575, 22528, 22482, 22435, 22388, 22341, 22294, 22248, 22201, 22154, 22106, 22059, 22012, 21965, 21918, 21870, 21823, 21775, 21728, 21680, 21633, 21585, 21537, 21489, 21442, 21394, 21346, 21298, 21250, 21202, 21154, 21106, 21057, 21009, 20961, 20913, 20864, 20816, 20768, 20719, 20671, 20622, 20573, 20525, 20476, 20427, 20379, 20330, 20281, 20232, 20183, 20134, 20085, 20036, 19987, 19938, 19889, 19840, 19791, 19742, 19692, 19643, 19594, 19544, 19495, 19446, 19396, 19347, 19297, 19248, 19198, 19149, 19099, 19050, 19000, 18950, 18901, 18851, 18801, 18751, 18702, 18652, 18602, 18552, 18502, 18452, 18403, 18353, 18303, 18253, 18203, 18153, 18103, 18053, 18003, 17953, 17903, 17853, 17802, 17752, 17702, 17652, 17602, 17552, 17502, 17451, 17401, 17351, 17301, 17251, 17200, 17150, 17100, 17050, 16999, 16949, 16899, 16849, 16798, 16748, 16698, 16648, 16597, 16547, 16497, 16446, 16396, 16346, 16295, 16245, 16195, 16145, 16094, 16044, 15994, 15944, 15893, 15843, 15793, 15742, 15692, 15642, 15592, 15542, 15491, 15441, 15391, 15341, 15291, 15240, 15190, 15140, 15090, 15040, 14990, 14940, 14889, 14839, 14789, 14739, 14689, 14639, 14589, 14539, 14489, 14439, 14389, 14340, 14290, 14240, 14190, 14140, 14090, 14041, 13991, 13941, 13891, 13842, 13792, 13742, 13693, 13643, 13593, 13544, 13494, 13445, 13395, 13346, 13297, 13247, 13198, 13149, 13099, 13050, 13001, 12952, 12903, 12853, 12804, 12755, 12706, 12657, 12608, 12559, 12510, 12462, 12413, 12364, 12315, 12267, 12218, 12169, 12121, 12072, 12024, 11975, 11927, 11878, 11830, 11782, 11734, 11685, 11637, 11589, 11541, 11493, 11445, 11397, 11349, 11301, 11254, 11206, 11158, 11111, 11063, 11015, 10968, 10921, 10873, 10826, 10779, 10731, 10684, 10637, 10590, 10543, 10496, 10449, 10402, 10355, 10309, 10262, 10215, 10169, 10122, 10076, 10029, 9983, 9937, 9891, 9845, 9798, 9752, 9707, 9661, 9615, 9569, 9523, 9478, 9432, 9387, 9341, 9296, 9250, 9205, 9160, 9115, 9070, 9025, 8980, 8935, 8890, 8846, 8801, 8757, 8712, 8668, 8623, 8579, 8535, 8491, 8447, 8403, 8359, 8315, 8271, 8228, 8184, 8141, 8097, 8054, 8011, 7968, 7924, 7881, 7838, 7796, 7753, 7710, 7667, 7625, 7582, 7540, 7498, 7456, 7413, 7371, 7329, 7288, 7246, 7204, 7162, 7121, 7080, 7038, 6997, 6956, 6915, 6874, 6833, 6792, 6751, 6711, 6670, 6630, 6589, 6549, 6509, 6469, 6429, 6389, 6349, 6309, 6270, 6230, 6191, 6151, 6112, 6073, 6034, 5995, 5956, 5917, 5879, 5840, 5802, 5764, 5725, 5687, 5649, 5611, 5573, 5536, 5498, 5460, 5423, 5386, 5348, 5311, 5274, 5237, 5201, 5164, 5127, 5091, 5054, 5018, 4982, 4946, 4910, 4874, 4838, 4803, 4767, 4732, 4696, 4661, 4626, 4591, 4556, 4522, 4487, 4452, 4418, 4384, 4350, 4316, 4282, 4248, 4214, 4180, 4147, 4113, 4080, 4047, 4014, 3981, 3948, 3916, 3883, 3851, 3818, 3786, 3754, 3722, 3690, 3658, 3627, 3595, 3564, 3533, 3502, 3470, 3440, 3409, 3378, 3348, 3317, 3287, 3257, 3227, 3197, 3167, 3137, 3108, 3078, 3049, 3020, 2991, 2962, 2933, 2905, 2876, 2848, 2819, 2791, 2763, 2735, 2708, 2680, 2653, 2625, 2598, 2571, 2544, 2517, 2490, 2464, 2437, 2411, 2385, 2359, 2333, 2307, 2281, 2256, 2230, 2205, 2180, 2155, 2130, 2105, 2081, 2056, 2032, 2008, 1984, 1960, 1936, 1912, 1889, 1865, 1842, 1819, 1796, 1773, 1751, 1728, 1706, 1683, 1661, 1639, 1617, 1596, 1574, 1553, 1531, 1510, 1489, 1468, 1448, 1427, 1406, 1386, 1366, 1346, 1326, 1306, 1287, 1267, 1248, 1229, 1210, 1191, 1172, 1153, 1135, 1117, 1098, 1080, 1062, 1045, 1027, 1010, 992, 975, 958, 941, 925, 908, 892, 875, 859, 843, 827, 812, 796, 781, 765, 750, 735, 720, 706, 691, 677, 663, 648, 634, 621, 607, 594, 580, 567, 554, 541, 528, 516, 503, 491, 479, 467, 455, 443, 432, 420, 409, 398, 387, 376, 366, 355, 345, 335, 325, 315, 305, 295, 286, 277, 267, 258, 250, 241, 232, 224, 216, 208, 200, 192, 184, 177, 170, 163, 156, 149, 142, 135, 129, 123, 117, 111, 105, 99, 94, 89, 83, 78, 74, 69, 64, 60, 56, 52, 48, 44, 40, 37, 34, 30, 27, 25, 22, 19, 17, 15, 13, 11, 9, 7, 6, 4, 3, 2, 1, 1, 0, 0, 0, 0,};

// short hanning[1024] = {0, 0, 1, 2, 4, 7, 11, 15, 19, 25, 30, 37, 44, 52, 60, 69, 79, 89, 100, 111, 123, 136, 149, 163, 177, 192, 208, 224, 241, 259, 277, 296, 315, 335, 355, 377, 398, 421, 444, 467, 491, 516, 542, 568, 594, 621, 649, 677, 706, 736, 766, 797, 828, 860, 892, 925, 959, 993, 1028, 1064, 1099, 1136, 1173, 1211, 1249, 1288, 1327, 1367, 1408, 1449, 1491, 1533, 1576, 1619, 1663, 1707, 1752, 1798, 1844, 1891, 1938, 1986, 2034, 2083, 2132, 2182, 2232, 2283, 2335, 2387, 2440, 2493, 2546, 2600, 2655, 2710, 2766, 2822, 2879, 2936, 2994, 3052, 3111, 3170, 3230, 3290, 3351, 3412, 3474, 3536, 3599, 3662, 3725, 3790, 3854, 3919, 3985, 4051, 4117, 4184, 4252, 4320, 4388, 4457, 4526, 4596, 4666, 4736, 4807, 4879, 4950, 5023, 5095, 5169, 5242, 5316, 5391, 5465, 5541, 5616, 5692, 5769, 5846, 5923, 6001, 6079, 6157, 6236, 6315, 6395, 6475, 6555, 6636, 6717, 6798, 6880, 6962, 7045, 7127, 7211, 7294, 7378, 7462, 7547, 7632, 7717, 7803, 7888, 7975, 8061, 8148, 8235, 8323, 8410, 8498, 8587, 8675, 8764, 8854, 8943, 9033, 9123, 9213, 9304, 9395, 9486, 9577, 9669, 9761, 9853, 9945, 10038, 10131, 10224, 10318, 10411, 10505, 10599, 10693, 10788, 10882, 10977, 11072, 11168, 11263, 11359, 11455, 11551, 11647, 11743, 11840, 11937, 12034, 12131, 12228, 12326, 12423, 12521, 12619, 12717, 12815, 12913, 13012, 13110, 13209, 13308, 13406, 13505, 13605, 13704, 13803, 13903, 14002, 14102, 14201, 14301, 14401, 14501, 14601, 14701, 14801, 14901, 15001, 15102, 15202, 15303, 15403, 15503, 15604, 15704, 15805, 15906, 16006, 16107, 16207, 16308, 16409, 16509, 16610, 16711, 16811, 16912, 17012, 17113, 17213, 17314, 17414, 17515, 17615, 17715, 17816, 17916, 18016, 18116, 18216, 18316, 18416, 18516, 18616, 18715, 18815, 18914, 19014, 19113, 19212, 19311, 19410, 19509, 19608, 19706, 19805, 19903, 20001, 20099, 20197, 20295, 20393, 20490, 20588, 20685, 20782, 20879, 20975, 21072, 21168, 21264, 21360, 21456, 21552, 21647, 21742, 21837, 21932, 22027, 22121, 22215, 22309, 22403, 22496, 22589, 22682, 22775, 22868, 22960, 23052, 23144, 23235, 23327, 23418, 23508, 23599, 23689, 23779, 23869, 23958, 24047, 24136, 24224, 24313, 24401, 24488, 24575, 24662, 24749, 24836, 24922, 25007, 25093, 25178, 25263, 25347, 25431, 25515, 25598, 25681, 25764, 25846, 25928, 26010, 26091, 26172, 26252, 26332, 26412, 26492, 26571, 26649, 26727, 26805, 26883, 26960, 27036, 27113, 27189, 27264, 27339, 27414, 27488, 27562, 27635, 27708, 27780, 27853, 27924, 27995, 28066, 28136, 28206, 28276, 28345, 28413, 28481, 28549, 28616, 28683, 28749, 28815, 28880, 28945, 29010, 29073, 29137, 29200, 29262, 29324, 29386, 29447, 29507, 29567, 29627, 29686, 29744, 29802, 29860, 29917, 29973, 30029, 30084, 30139, 30194, 30248, 30301, 30354, 30406, 30458, 30509, 30560, 30610, 30660, 30709, 30757, 30805, 30853, 30900, 30946, 30992, 31037, 31082, 31126, 31170, 31213, 31255, 31297, 31339, 31380, 31420, 31459, 31499, 31537, 31575, 31613, 31649, 31686, 31721, 31756, 31791, 31825, 31858, 31891, 31923, 31955, 31986, 32016, 32046, 32075, 32104, 32132, 32159, 32186, 32212, 32238, 32263, 32288, 32312, 32335, 32358, 32380, 32401, 32422, 32442, 32462, 32481, 32499, 32517, 32534, 32551, 32567, 32582, 32597, 32611, 32625, 32638, 32650, 32662, 32673, 32683, 32693, 32703, 32711, 32719, 32727, 32733, 32740, 32745, 32750, 32754, 32758, 32761, 32764, 32766, 32767, 32767, 32767, 32767, 32766, 32764, 32761, 32758, 32754, 32750, 32745, 32740, 32733, 32727, 32719, 32711, 32703, 32693, 32683, 32673, 32662, 32650, 32638, 32625, 32611, 32597, 32582, 32567, 32551, 32534, 32517, 32499, 32481, 32462, 32442, 32422, 32401, 32380, 32358, 32335, 32312, 32288, 32263, 32238, 32212, 32186, 32159, 32132, 32104, 32075, 32046, 32016, 31986, 31955, 31923, 31891, 31858, 31825, 31791, 31756, 31721, 31686, 31649, 31613, 31575, 31537, 31499, 31459, 31420, 31380, 31339, 31297, 31255, 31213, 31170, 31126, 31082, 31037, 30992, 30946, 30900, 30853, 30805, 30757, 30709, 30660, 30610, 30560, 30509, 30458, 30406, 30354, 30301, 30248, 30194, 30139, 30084, 30029, 29973, 29917, 29860, 29802, 29744, 29686, 29627, 29567, 29507, 29447, 29386, 29324, 29262, 29200, 29137, 29073, 29010, 28945, 28880, 28815, 28749, 28683, 28616, 28549, 28481, 28413, 28345, 28276, 28206, 28136, 28066, 27995, 27924, 27853, 27780, 27708, 27635, 27562, 27488, 27414, 27339, 27264, 27189, 27113, 27036, 26960, 26883, 26805, 26727, 26649, 26571, 26492, 26412, 26332, 26252, 26172, 26091, 26010, 25928, 25846, 25764, 25681, 25598, 25515, 25431, 25347, 25263, 25178, 25093, 25007, 24922, 24836, 24749, 24662, 24576, 24488, 24401, 24313, 24224, 24136, 24047, 23958, 23869, 23779, 23689, 23599, 23508, 23418, 23327, 23235, 23144, 23052, 22960, 22868, 22775, 22682, 22589, 22496, 22403, 22309, 22215, 22121, 22027, 21932, 21837, 21742, 21647, 21552, 21456, 21360, 21264, 21168, 21072, 20975, 20879, 20782, 20685, 20588, 20490, 20393, 20295, 20197, 20099, 20001, 19903, 19805, 19706, 19608, 19509, 19410, 19311, 19212, 19113, 19014, 18914, 18815, 18715, 18616, 18516, 18416, 18316, 18216, 18116, 18016, 17916, 17816, 17715, 17615, 17515, 17414, 17314, 17213, 17113, 17012, 16912, 16811, 16711, 16610, 16509, 16409, 16308, 16207, 16107, 16006, 15906, 15805, 15704, 15604, 15503, 15403, 15303, 15202, 15102, 15001, 14901, 14801, 14701, 14601, 14501, 14401, 14301, 14201, 14102, 14002, 13903, 13803, 13704, 13605, 13505, 13406, 13308, 13209, 13110, 13012, 12913, 12815, 12717, 12619, 12521, 12423, 12326, 12228, 12131, 12034, 11937, 11840, 11743, 11647, 11551, 11455, 11359, 11263, 11168, 11072, 10977, 10882, 10788, 10693, 10599, 10505, 10411, 10318, 10224, 10131, 10038, 9945, 9853, 9761, 9669, 9577, 9486, 9395, 9304, 9213, 9123, 9033, 8943, 8854, 8764, 8675, 8587, 8498, 8410, 8323, 8235, 8148, 8061, 7975, 7888, 7803, 7717, 7632, 7547, 7462, 7378, 7294, 7211, 7127, 7045, 6962, 6880, 6798, 6717, 6636, 6555, 6475, 6395, 6315, 6236, 6157, 6079, 6001, 5923, 5846, 5769, 5692, 5616, 5541, 5465, 5391, 5316, 5242, 5169, 5095, 5023, 4950, 4879, 4807, 4736, 4666, 4596, 4526, 4457, 4388, 4320, 4252, 4184, 4117, 4051, 3985, 3919, 3854, 3790, 3725, 3662, 3599, 3536, 3474, 3412, 3351, 3290, 3230, 3170, 3111, 3052, 2994, 2936, 2879, 2822, 2766, 2710, 2655, 2600, 2546, 2493, 2440, 2387, 2335, 2283, 2232, 2182, 2132, 2083, 2034, 1986, 1938, 1891, 1844, 1798, 1752, 1707, 1663, 1619, 1576, 1533, 1491, 1449, 1408, 1367, 1327, 1288, 1249, 1211, 1173, 1136, 1099, 1064, 1028, 993, 959, 925, 892, 860, 828, 797, 766, 736, 706, 677, 649, 621, 594, 568, 542, 516, 491, 467, 444, 421, 398, 377, 355, 335, 315, 296, 277, 259, 241, 224, 208, 192, 177, 163, 149, 136, 123, 111, 100, 89, 79, 69, 60, 52, 44, 37, 30, 25, 19, 15, 11, 7, 4, 2, 1, 0, 0,};

double hanning[1024] = {0.0000000000,0.0000094310,0.0000377230,0.0000848750,0.0001508850,0.0002357510,0.0003394700,0.0004620380,0.0006034500,0.0007637000,
0.0009427830,0.0011406930,0.0013574200,0.0015929580,0.0018472980,0.0021204290,0.0024123420,0.0027230260,0.0030524680,0.0034006570,
0.0037675780,0.0041532200,0.0045575660,0.0049806020,0.0054223110,0.0058826780,0.0063616840,0.0068593110,0.0073755420,0.0079103550,
0.0084637320,0.0090356510,0.0096260910,0.0102350290,0.0108624430,0.0115083080,0.0121726010,0.0128552960,0.0135563680,0.0142757900,
0.0150135350,0.0157695750,0.0165438820,0.0173364260,0.0181471780,0.0189761070,0.0198231810,0.0206883690,0.0215716390,0.0224729560,
0.0233922870,0.0243295970,0.0252848510,0.0262580120,0.0272490450,0.0282579110,0.0292845720,0.0303289910,0.0313911270,0.0324709400,
0.0335683900,0.0346834350,0.0358160330,0.0369661420,0.0381337180,0.0393187170,0.0405210940,0.0417408040,0.0429778010,0.0442320390,
0.0455034690,0.0467920440,0.0480977160,0.0494204350,0.0507601510,0.0521168140,0.0534903720,0.0548807750,0.0562879680,0.0577119000,
0.0591525160,0.0606097620,0.0620835830,0.0635739240,0.0650807280,0.0666039390,0.0681434980,0.0696993490,0.0712714320,0.0728596880,
0.0744640570,0.0760844780,0.0777208910,0.0793732340,0.0810414430,0.0827254580,0.0844252130,0.0861406450,0.0878716890,0.0896182790,
0.0913803510,0.0931578370,0.0949506700,0.0967587830,0.0985821080,0.1004205750,0.1022741150,0.1041426590,0.1060261360,0.1079244750,
0.1098376050,0.1117654520,0.1137079450,0.1156650090,0.1176365720,0.1196225600,0.1216228960,0.1236375050,0.1256663120,0.1277092410,
0.1297662130,0.1318371510,0.1339219780,0.1360206140,0.1381329810,0.1402589980,0.1423985860,0.1445516640,0.1467181510,0.1488979640,
0.1510910220,0.1532972420,0.1555165400,0.1577488340,0.1599940380,0.1622520690,0.1645228400,0.1668062670,0.1691022620,0.1714107400,
0.1737316140,0.1760647950,0.1784101960,0.1807677290,0.1831373040,0.1855188320,0.1879122230,0.1903173870,0.1927342330,0.1951626710,
0.1976026070,0.2000539510,0.2025166100,0.2049904910,0.2074755010,0.2099715450,0.2124785300,0.2149963620,0.2175249450,0.2200641830,
0.2226139820,0.2251742440,0.2277448740,0.2303257740,0.2329168470,0.2355179950,0.2381291200,0.2407501240,0.2433809070,0.2460213710,
0.2486714160,0.2513309420,0.2539998480,0.2566780340,0.2593653990,0.2620618410,0.2647672600,0.2674815520,0.2702046150,0.2729363470,
0.2756766440,0.2784254040,0.2811825220,0.2839478940,0.2867214170,0.2895029850,0.2922924930,0.2950898380,0.2978949120,0.3007076100,
0.3035278250,0.3063554530,0.3091903850,0.3120325150,0.3148817360,0.3177379400,0.3206010200,0.3234708670,0.3263473740,0.3292304310,
0.3321199300,0.3350157620,0.3379178170,0.3408259870,0.3437401620,0.3466602310,0.3495860840,0.3525176120,0.3554547030,0.3583972470,
0.3613451320,0.3642982480,0.3672564830,0.3702197260,0.3731878640,0.3761607860,0.3791383790,0.3821205320,0.3851071320,0.3880980660,
0.3910932210,0.3940924840,0.3970957420,0.4001028830,0.4031137920,0.4061283550,0.4091464600,0.4121679920,0.4151928370,0.4182208820,
0.4212520110,0.4242861110,0.4273230670,0.4303627650,0.4334050900,0.4364499270,0.4394971610,0.4425466780,0.4455983620,0.4486520980,
0.4517077710,0.4547652660,0.4578244670,0.4608852590,0.4639475270,0.4670111550,0.4700760270,0.4731420280,0.4762090420,0.4792769540,
0.4823456470,0.4854150060,0.4884849160,0.4915552600,0.4946259220,0.4976967880,0.5007677400,0.5038386630,0.5069094410,0.5099799590,
0.5130501000,0.5161197490,0.5191887900,0.5222571070,0.5253245840,0.5283911060,0.5314565580,0.5345208220,0.5375837840,0.5406453290,
0.5437053400,0.5467637020,0.5498203010,0.5528750200,0.5559277440,0.5589783590,0.5620267480,0.5650727980,0.5681163930,0.5711574190,
0.5741957600,0.5772313030,0.5802639320,0.5832935330,0.5863199920,0.5893431950,0.5923630280,0.5953793760,0.5983921270,0.6014011660,
0.6044063790,0.6074076540,0.6104048770,0.6133979360,0.6163867170,0.6193711070,0.6223509940,0.6253262660,0.6282968100,0.6312625150,
0.6342232670,0.6371789570,0.6401294710,0.6430747000,0.6460145310,0.6489488540,0.6518775590,0.6548005340,0.6577176690,0.6606288550,
0.6635339820,0.6664329390,0.6693256180,0.6722119100,0.6750917050,0.6779648960,0.6808313720,0.6836910280,0.6865437540,0.6893894430,
0.6922279870,0.6950592810,0.6978832160,0.7006996860,0.7035085850,0.7063098070,0.7091032470,0.7118887980,0.7146663570,0.7174358180,
0.7201970760,0.7229500280,0.7256945690,0.7284305960,0.7311580070,0.7338766970,0.7365865650,0.7392875080,0.7419794240,0.7446622130,
0.7473357710,0.7500000000,0.7526547980,0.7553000650,0.7579357010,0.7605616070,0.7631776840,0.7657838330,0.7683799550,0.7709659540,
0.7735417310,0.7761071890,0.7786622320,0.7812067620,0.7837406850,0.7862639040,0.7887763240,0.7912778510,0.7937683890,0.7962478460,
0.7987161280,0.8011731410,0.8036187930,0.8060529910,0.8084756440,0.8108866610,0.8132859500,0.8156734210,0.8180489830,0.8204125480,
0.8227640260,0.8251033290,0.8274303670,0.8297450540,0.8320473010,0.8343370230,0.8366141330,0.8388785440,0.8411301720,0.8433689320,
0.8455947380,0.8478075080,0.8500071570,0.8521936030,0.8543667630,0.8565265560,0.8586728990,0.8608057120,0.8629249140,0.8650304250,
0.8671221670,0.8692000590,0.8712640240,0.8733139840,0.8753498610,0.8773715790,0.8793790610,0.8813722320,0.8833510170,0.8853153400,
0.8872651280,0.8892003070,0.8911208040,0.8930265470,0.8949174640,0.8967934840,0.8986545350,0.9005005470,0.9023314520,0.9041471790,
0.9059476610,0.9077328290,0.9095026160,0.9112569550,0.9129957810,0.9147190270,0.9164266280,0.9181185210,0.9197946410,0.9214549250,
0.9230993100,0.9247277350,0.9263401380,0.9279364580,0.9295166350,0.9310806090,0.9326283220,0.9341597140,0.9356747280,0.9371733080,
0.9386553960,0.9401209370,0.9415698750,0.9430021550,0.9444177240,0.9458165290,0.9471985150,0.9485636320,0.9499118280,0.9512430520,
0.9525572540,0.9538543830,0.9551343920,0.9563972320,0.9576428550,0.9588712140,0.9600822640,0.9612759580,0.9624522500,0.9636110980,
0.9647524570,0.9658762840,0.9669825370,0.9680711740,0.9691421530,0.9701954360,0.9712309810,0.9722487490,0.9732487030,0.9742308050,
0.9751950170,0.9761413030,0.9770696280,0.9779799560,0.9788722540,0.9797464870,0.9806026220,0.9814406280,0.9822604720,0.9830621240,
0.9838455530,0.9846107300,0.9853576260,0.9860862130,0.9867964630,0.9874883500,0.9881618470,0.9888169290,0.9894535720,0.9900717510,
0.9906714420,0.9912526250,0.9918152750,0.9923593730,0.9928848980,0.9933918290,0.9938801480,0.9943498370,0.9948008770,0.9952332510,
0.9956469440,0.9960419400,0.9964182230,0.9967757800,0.9971145970,0.9974346620,0.9977359610,0.9980184850,0.9982822210,0.9985271610,
0.9987532950,0.9989606150,0.9991491120,0.9993187800,0.9994696110,0.9996016020,0.9997147450,0.9998090380,0.9998844770,0.9999410590,
0.9999787810,0.9999976420,0.9999976420,0.9999787810,0.9999410590,0.9998844770,0.9998090380,0.9997147450,0.9996016020,0.9994696110,
0.9993187800,0.9991491120,0.9989606150,0.9987532950,0.9985271610,0.9982822210,0.9980184850,0.9977359610,0.9974346620,0.9971145970,
0.9967757800,0.9964182230,0.9960419400,0.9956469440,0.9952332510,0.9948008770,0.9943498370,0.9938801480,0.9933918290,0.9928848980,
0.9923593730,0.9918152750,0.9912526250,0.9906714420,0.9900717510,0.9894535720,0.9888169290,0.9881618470,0.9874883500,0.9867964630,
0.9860862130,0.9853576260,0.9846107300,0.9838455530,0.9830621240,0.9822604720,0.9814406280,0.9806026220,0.9797464870,0.9788722540,
0.9779799560,0.9770696280,0.9761413030,0.9751950170,0.9742308050,0.9732487030,0.9722487490,0.9712309810,0.9701954360,0.9691421530,
0.9680711740,0.9669825370,0.9658762840,0.9647524570,0.9636110980,0.9624522500,0.9612759580,0.9600822640,0.9588712140,0.9576428550,
0.9563972320,0.9551343920,0.9538543830,0.9525572540,0.9512430520,0.9499118280,0.9485636320,0.9471985150,0.9458165290,0.9444177240,
0.9430021550,0.9415698750,0.9401209370,0.9386553960,0.9371733080,0.9356747280,0.9341597140,0.9326283220,0.9310806090,0.9295166350,
0.9279364580,0.9263401380,0.9247277350,0.9230993100,0.9214549250,0.9197946410,0.9181185210,0.9164266280,0.9147190270,0.9129957810,
0.9112569550,0.9095026160,0.9077328290,0.9059476610,0.9041471790,0.9023314520,0.9005005470,0.8986545350,0.8967934840,0.8949174640,
0.8930265470,0.8911208040,0.8892003070,0.8872651280,0.8853153400,0.8833510170,0.8813722320,0.8793790610,0.8773715790,0.8753498610,
0.8733139840,0.8712640240,0.8692000590,0.8671221670,0.8650304250,0.8629249140,0.8608057120,0.8586728990,0.8565265560,0.8543667630,
0.8521936030,0.8500071570,0.8478075080,0.8455947380,0.8433689320,0.8411301720,0.8388785440,0.8366141330,0.8343370230,0.8320473010,
0.8297450540,0.8274303670,0.8251033290,0.8227640260,0.8204125480,0.8180489830,0.8156734210,0.8132859500,0.8108866610,0.8084756440,
0.8060529910,0.8036187930,0.8011731410,0.7987161280,0.7962478460,0.7937683890,0.7912778510,0.7887763240,0.7862639040,0.7837406850,
0.7812067620,0.7786622320,0.7761071890,0.7735417310,0.7709659540,0.7683799550,0.7657838330,0.7631776840,0.7605616070,0.7579357010,
0.7553000650,0.7526547980,0.7500000000,0.7473357710,0.7446622130,0.7419794240,0.7392875080,0.7365865650,0.7338766970,0.7311580070,
0.7284305960,0.7256945690,0.7229500280,0.7201970760,0.7174358180,0.7146663570,0.7118887980,0.7091032470,0.7063098070,0.7035085850,
0.7006996860,0.6978832160,0.6950592810,0.6922279870,0.6893894430,0.6865437540,0.6836910280,0.6808313720,0.6779648960,0.6750917050,
0.6722119100,0.6693256180,0.6664329390,0.6635339820,0.6606288550,0.6577176690,0.6548005340,0.6518775590,0.6489488540,0.6460145310,
0.6430747000,0.6401294710,0.6371789570,0.6342232670,0.6312625150,0.6282968100,0.6253262660,0.6223509940,0.6193711070,0.6163867170,
0.6133979360,0.6104048770,0.6074076540,0.6044063790,0.6014011660,0.5983921270,0.5953793760,0.5923630280,0.5893431950,0.5863199920,
0.5832935330,0.5802639320,0.5772313030,0.5741957600,0.5711574190,0.5681163930,0.5650727980,0.5620267480,0.5589783590,0.5559277440,
0.5528750200,0.5498203010,0.5467637020,0.5437053400,0.5406453290,0.5375837840,0.5345208220,0.5314565580,0.5283911060,0.5253245840,
0.5222571070,0.5191887900,0.5161197490,0.5130501000,0.5099799590,0.5069094410,0.5038386630,0.5007677400,0.4976967880,0.4946259220,
0.4915552600,0.4884849160,0.4854150060,0.4823456470,0.4792769540,0.4762090420,0.4731420280,0.4700760270,0.4670111550,0.4639475270,
0.4608852590,0.4578244670,0.4547652660,0.4517077710,0.4486520980,0.4455983620,0.4425466780,0.4394971610,0.4364499270,0.4334050900,
0.4303627650,0.4273230670,0.4242861110,0.4212520110,0.4182208820,0.4151928370,0.4121679920,0.4091464600,0.4061283550,0.4031137920,
0.4001028830,0.3970957420,0.3940924840,0.3910932210,0.3880980660,0.3851071320,0.3821205320,0.3791383790,0.3761607860,0.3731878640,
0.3702197260,0.3672564830,0.3642982480,0.3613451320,0.3583972470,0.3554547030,0.3525176120,0.3495860840,0.3466602310,0.3437401620,
0.3408259870,0.3379178170,0.3350157620,0.3321199300,0.3292304310,0.3263473740,0.3234708670,0.3206010200,0.3177379400,0.3148817360,
0.3120325150,0.3091903850,0.3063554530,0.3035278250,0.3007076100,0.2978949120,0.2950898380,0.2922924930,0.2895029850,0.2867214170,
0.2839478940,0.2811825220,0.2784254040,0.2756766440,0.2729363470,0.2702046150,0.2674815520,0.2647672600,0.2620618410,0.2593653990,
0.2566780340,0.2539998480,0.2513309420,0.2486714160,0.2460213710,0.2433809070,0.2407501240,0.2381291200,0.2355179950,0.2329168470,
0.2303257740,0.2277448740,0.2251742440,0.2226139820,0.2200641830,0.2175249450,0.2149963620,0.2124785300,0.2099715450,0.2074755010,
0.2049904910,0.2025166100,0.2000539510,0.1976026070,0.1951626710,0.1927342330,0.1903173870,0.1879122230,0.1855188320,0.1831373040,
0.1807677290,0.1784101960,0.1760647950,0.1737316140,0.1714107400,0.1691022620,0.1668062670,0.1645228400,0.1622520690,0.1599940380,
0.1577488340,0.1555165400,0.1532972420,0.1510910220,0.1488979640,0.1467181510,0.1445516640,0.1423985860,0.1402589980,0.1381329810,
0.1360206140,0.1339219780,0.1318371510,0.1297662130,0.1277092410,0.1256663120,0.1236375050,0.1216228960,0.1196225600,0.1176365720,
0.1156650090,0.1137079450,0.1117654520,0.1098376050,0.1079244750,0.1060261360,0.1041426590,0.1022741150,0.1004205750,0.0985821080,
0.0967587830,0.0949506700,0.0931578370,0.0913803510,0.0896182790,0.0878716890,0.0861406450,0.0844252130,0.0827254580,0.0810414430,
0.0793732340,0.0777208910,0.0760844780,0.0744640570,0.0728596880,0.0712714320,0.0696993490,0.0681434980,0.0666039390,0.0650807280,
0.0635739240,0.0620835830,0.0606097620,0.0591525160,0.0577119000,0.0562879680,0.0548807750,0.0534903720,0.0521168140,0.0507601510,
0.0494204350,0.0480977160,0.0467920440,0.0455034690,0.0442320390,0.0429778010,0.0417408040,0.0405210940,0.0393187170,0.0381337180,
0.0369661420,0.0358160330,0.0346834350,0.0335683900,0.0324709400,0.0313911270,0.0303289910,0.0292845720,0.0282579110,0.0272490450,
0.0262580120,0.0252848510,0.0243295970,0.0233922870,0.0224729560,0.0215716390,0.0206883690,0.0198231810,0.0189761070,0.0181471780,
0.0173364260,0.0165438820,0.0157695750,0.0150135350,0.0142757900,0.0135563680,0.0128552960,0.0121726010,0.0115083080,0.0108624430,
0.0102350290,0.0096260910,0.0090356510,0.0084637320,0.0079103550,0.0073755420,0.0068593110,0.0063616840,0.0058826780,0.0054223110,
0.0049806020,0.0045575660,0.0041532200,0.0037675780,0.0034006570,0.0030524680,0.0027230260,0.0024123420,0.0021204290,0.0018472980,
0.0015929580,0.0013574200,0.0011406930,0.0009427830,0.0007637000,0.0006034500,0.0004620380,0.0003394700,0.0002357510,0.0001508850,
0.0000848750,0.0000377230,0.0000094310,0.0000000000,};
/*
   fix_mpy() - fixed-point multiplication
 */
short gst_spectrum_fix_mpy (short a, short b)
{
  FIX_MPY (a, a, b);
  return a;
}

/*
   fix_fft() - perform fast Fourier transform.

   if n>0 FFT is done, if n<0 inverse FFT is done
   fr[n],fi[n] are real,imaginary arrays, INPUT AND RESULT.
   size of data = 2**m
   set inverse to 0=dft, 1=idft
 */
int gst_spectrum_fix_fft (short fr[], short fi[], int m, int inverse)
{
  int mr, nn, i, j, l, k, istep, n, scale, shift;
  short qr, qi, tr, ti, wr, wi;

  n = 1 << m;

  if (n > N_WAVE)
    return -1;

  mr = 0;
  nn = n - 1;
  scale = 0;

  /* decimation in time - re-order data */
  for (m = 1; m <= nn; ++m) {
    l = n;
    do {
      l >>= 1;
    }
    while (mr + l > nn);
    mr = (mr & (l - 1)) + l;

    if (mr <= m)
      continue;
    tr = fr[m];
    fr[m] = fr[mr];
    fr[mr] = tr;
    ti = fi[m];
    fi[m] = fi[mr];
    fi[mr] = ti;
  }

  l = 1;
  k = LOG2_N_WAVE - 1;
  while (l < n) {
    if (inverse) {
      /* variable scaling, depending upon data */
      shift = 0;
      for (i = 0; i < n; ++i) {
        j = fr[i];
        if (j < 0)
          j = -j;
        m = fi[i];
        if (m < 0)
          m = -m;
        if (j > 16383 || m > 16383) {
          shift = 1;
          break;
        }
      }
      if (shift)
        ++scale;
    } else {
      /* fixed scaling, for proper normalization -
         there will be log2(n) passes, so this
         results in an overall factor of 1/n,
         distributed to maximize arithmetic accuracy. */
      shift = 1;
    }
    /* it may not be obvious, but the shift will be performed
       on each data point exactly once, during this pass. */
    istep = l << 1;
    for (m = 0; m < l; ++m) {
      j = m << k;
      /* 0 <= j < N_WAVE/2 */
      wr = gst_spectrum_Sinewave[j + N_WAVE / 4];
      wi = -gst_spectrum_Sinewave[j];
      if (inverse)
        wi = -wi;
      if (shift) {
        wr >>= 1;
        wi >>= 1;
      }
      for (i = m; i < n; i += istep) {
        j = i + l;
        tr = gst_spectrum_fix_mpy (wr, fr[j]) -
            gst_spectrum_fix_mpy (wi, fi[j]);
        ti = gst_spectrum_fix_mpy (wr, fi[j]) +
            gst_spectrum_fix_mpy (wi, fr[j]);
        qr = fr[i];
        qi = fi[i];
        if (shift) {
          qr >>= 1;
          qi >>= 1;
        }
        fr[j] = qr - tr;
        fi[j] = qi - ti;
        fr[i] = qr + tr;
        fi[i] = qi + ti;
      }
    }
    --k;
    l = istep;
  }

  return scale;
}

#endif
